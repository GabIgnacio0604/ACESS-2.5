<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Student Council Dashboard</title>
  <link rel="stylesheet" href="../CSS/ACESS_StudentCouncil.css" />
  <link rel="stylesheet" href="../CSS/ACESS_StudentCouncil_And_User.css">
  <link rel="stylesheet" href="../CSS/ACESS_Universal_Sidebar.css" />
  <script src="../JS/config.js"></script>
</head>

<body>
  <div class="dashboard-container">
    <!-- Sidebar -->
    <aside class="sidebar">
      <a href="ACESS_Admin_Dashboard.html">
        <img src="../Images/School_Logo.jpg" alt="Logo" class="logo">
      </a>
      <p class="account-name" id="account-name">Loading...</p>
      <nav class="sidebar-nav">
        <a href="ACESS_Admin_Club.html">
          👥 Club
        </a>
        <a href="ACESS_Student_Council.html">
          🏛️ Student Council
        </a>
        <a href="ACESS_Messages.html">
          💬 Messages
        </a>
        <a href="ACESS_AccountManagement.html">
          👤 Account Management
        </a>
      </nav>
      <button class="logout-btn" id="logoutButton">Logout</button>
    </aside>

    <!-- Main Content -->
    <main class="main-content">
      <!-- Page Header -->
      <div class="page-header">
        <h1>Student Council Management</h1>
        <p>Manage candidates and voting system</p>
      </div>

      <!-- Voting Controls -->
      <section class="controls-section">
        <div class="voting-status" id="voting-status">
          <span>Voting Status: <strong id="status-text">LOADING...</strong></span>
          <small>Last Updated: <span id="last-updated">--</span></small>
        </div>
        <div class="controls-buttons">
          <button class="btn btn-success" id="activateVotingBtn" disabled>Activate Voting</button>
          <button class="btn btn-danger" id="deactivateVotingBtn" disabled>Deactivate Voting</button>
          <button class="btn btn-primary" id="addCandidateBtn">+ Add Candidate</button>
          <button class="btn btn-warning" id="viewStatsBtn">📊 View Statistics</button>
        </div>
      </section>

      <!-- Executive Positions -->
      <section class="positions-section">
        <h2>Executive Positions</h2>
        <div class="positions-grid" id="executivePositions"></div>
      </section>

      <!-- Grade Level Representatives -->
      <section class="positions-section">
        <h2>Grade Level Representatives</h2>
        <div class="positions-grid" id="gradePositions"></div>
      </section>

      <!-- Statistics Section (Hidden by default) -->
      <section class="statistics-section" id="statsSection" style="display: none;">
        <h2>Voting Statistics</h2>
        <div id="statsContainer"></div>
      </section>
    </main>
  </div>

  <!-- Add/Edit Candidate Modal -->
  <div class="modal-overlay" id="candidateModal">
    <div class="modal-content">
      <h3 class="modal-header" id="modalTitle">Add New Candidate</h3>
      <form id="candidateForm">
        <div class="form-group">
          <label for="candidateName">Candidate Name:</label>
          <input type="text" id="candidateName" required placeholder="Enter full name">
        </div>
        <div class="form-group">
          <label for="candidatePosition">Position:</label>
          <select id="candidatePosition" required>
            <option value="">Select a position</option>
            <option value="President">President</option>
            <option value="Vice President">Vice President</option>
            <option value="Secretary">Secretary</option>
            <option value="Treasurer">Treasurer</option>
            <option value="Auditor">Auditor</option>
            <option value="P.I.O">P.I.O</option>
            <option value="P.O">P.O</option>
            <option value="Grade 12">Grade 12 Representative</option>
            <option value="Grade 11">Grade 11 Representative</option>
            <option value="Grade 10">Grade 10 Representative</option>
            <option value="Grade 9">Grade 9 Representative</option>
            <option value="Grade 8">Grade 8 Representative</option>
            <option value="Grade 7">Grade 7 Representative</option>
          </select>
        </div>
        <div class="form-group">
          <label for="candidatePhoto">Photo:</label>
          <input type="file" id="candidatePhoto" accept="image/*">
          <div class="image-preview" id="imagePreview">
            <span style="color: #6c757d;">No image selected</span>
          </div>
        </div>
        <div class="modal-buttons">
          <button type="submit" class="btn btn-primary">Save</button>
          <button type="button" class="btn btn-danger" id="cancelModalBtn">Cancel</button>
        </div>
      </form>
    </div>
  </div>
<script src="../JS/session_manager.js"></script>
  <script src="../JS/main.js"></script>
  <script src="../Admin/JS/student_council.js"></script>
  <script>
    document.addEventListener("DOMContentLoaded", async () => {
      const nameElement = document.querySelector(".account-name");

      try {
        const res = await fetch("Php/get_logged_user.php");
        const data = await res.json();

        if (data.fullname) {
          nameElement.textContent = data.fullname;
        } else {
          nameElement.textContent = "Not Logged In";
          console.error("Error fetching name:", data.error);
        }
      } catch (err) {
        console.error("Fetch failed:", err);
        nameElement.textContent = "Error";
      }
    });
  </script>
</body>

</html>